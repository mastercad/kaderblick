# Spiele

Die Spielverwaltung ist das Herzst√ºck von Kaderblick. Hier werden alle Spiele eures Teams dokumentiert ‚Äì von der Ansetzung √ºber das Live-Protokoll bis zur Nachbereitung mit Videos.

---

## Die Spiel√ºbersicht

Unter **‚ÄûSpiele"** im Men√º findet ihr alle Spiele eures Teams ‚Äì √ºbersichtlich aufgeteilt in drei Kategorien:

| Bereich | Was steht dort? |
|---|---|
| **Laufende Spiele** | Spiele, die gerade stattfinden (Startzeit war, Endzeit liegt noch in der Zukunft) |
| **Bevorstehende Spiele** | Geplante Spiele, die noch nicht begonnen haben ‚Äì sortiert nach Datum |
| **Vergangene Spiele** | Abgelaufene Spiele mit dem Endergebnis |

---

## Ein Spiel anlegen

Nur Administratoren und berechtigte Trainer k√∂nnen neue Spiele anlegen.

1. Im Men√º auf **‚ÄûSpiele"** klicken
2. Auf **‚ÄûNeues Spiel"** klicken
3. Folgende Angaben machen:

| Feld | Beschreibung | Pflicht? |
|---|---|---|
| **Heimteam** | Welches Team spielt zuhause? | Empfohlen |
| **Ausw√§rtsteam** | Welches Team ist zu Gast? (darf nicht dasselbe sein) | Empfohlen |
| **Spieltyp** | Ligaspiel, Freundschaftsspiel, Pokalspiel, ‚Ä¶ | ‚úÖ Ja |
| **Spielort** | Wo findet das Spiel statt? | Empfohlen |
| **Liga** | Optionale Zuordnung zu einer Liga | Nein |

4. Speichern

> üí° **Wichtig:** Datum und Uhrzeit werden √ºber den **Kalender** gesteuert. Das Spiel bekommt automatisch einen Terminslot, den ihr im Kalender sehen und zu dem Spieler ihre Zu-/Absage geben k√∂nnen.

---

## Das Spiel live dokumentieren

Die Detailseite eines Spiels ist der zentrale Ort f√ºr die Spieldokumentation. √ñffnet das Spiel, indem ihr in der Liste darauf klickt.

### Spielereignisse erfassen

W√§hrend des Spiels (oder im Nachhinein) k√∂nnen alle wichtigen Ereignisse eingetragen werden:

| Ereignis | Wann eintragen |
|---|---|
| ‚öΩ **Tor** | Ein regul√§res Tor wurde erzielt |
| üôà **Eigentor** | Ein Tor gegen das eigene Team |
| üü® **Gelbe Karte** | Ein Spieler wurde verwarnt |
| üü• **Rote Karte** | Ein Spieler wurde des Feldes verwiesen |
| üü®üü• **Gelb-Rote Karte** | Zweite Gelbe Karte = Feldverweis |
| üîÑ **Wechsel** | Ein Spieler wird ausgewechselt |
| üëü **Assist/Vorlage** | Vorlagengeber zu einem Tor |

So wird ein Ereignis eingetragen:
1. Auf **‚ÄûEreignis hinzuf√ºgen"** klicken
2. Ereignistyp w√§hlen (z. B. Tor)
3. Spieler ausw√§hlen (wer hat das Tor geschossen?)
4. Spielminute eintragen
5. Bei Tor: Optional den Vorbereiter (Assist-Geber) angeben
6. Speichern

### Der Spielstand

Der aktuelle Spielstand wird **automatisch** aus den eingetragenen Toren und Eigentoren berechnet ‚Äì ihr m√ºsst das Ergebnis nicht separat eingeben. Das System z√§hlt die Tore f√ºr jedes Team und zeigt das aktuelle Ergebnis an.

---

## Wechsel erfassen

Spielerwechsel werden separat dokumentiert:

1. Auf **‚ÄûWechsel hinzuf√ºgen"** klicken
2. Den **eingewechselten** Spieler w√§hlen
3. Den **ausgewechselten** Spieler w√§hlen
4. Spielminute eintragen
5. Optional: Wechselgrund angeben
6. Speichern

---

## Spiel abschlie√üen

Wenn das Spiel vorbei ist, k√∂nnt ihr es als **‚ÄûAbgeschlossen"** markieren. Damit wird es in die Kategorie der vergangenen Spiele verschoben und das Ergebnis ist final festgehalten.

---

## Spieldetailseite ‚Äì was seht ihr dort?

Die Detailseite eines Spiels zeigt alles auf einen Blick:

- **Heimteam vs. Ausw√§rtsteam** mit aktuellem Spielstand
- **Chronologische Ereignisliste** ‚Äì alle Tore, Karten und Wechsel in zeitlicher Reihenfolge
- **Verkn√ºpfte Videos** ‚Äì falls Spielvideos hochgeladen wurden, k√∂nnt ihr Spielszenen direkt anspringen
- **Wetterdaten** ‚Äì das Wetter zum Spielzeitpunkt
- **Teilnahmestatus** ‚Äì wer hat zugesagt, wer fehlt?

---

## Spielorte verwalten

Spielorte (Sportanlagen, Pl√§tze) werden einmalig angelegt und k√∂nnen dann bei jedem Spiel ausgew√§hlt werden. Das spart Zeit bei wiederkehrenden Heimspielen.

Neue Spielorte anlegen: Im Men√º auf **‚ÄûSpielorte"** klicken.

---

## Automatische Synchronisation mit fussball.de

Wenn euer Team mit dem Portal **fussball.de** verkn√ºpft ist, werden Spielergebnisse nach dem Spieltag automatisch √ºbernommen. Ihr m√ºsst nichts manuell eintragen ‚Äì das System erledigt das von alleine!

---

## Berechtigungen: Wer sieht was?

- **Spieler und Eltern** sehen nur die Spiele des Teams, dem sie zugeordnet sind
- **Trainer** sehen alle Spiele ihrer Teams und k√∂nnen Spielereignisse nachtragen
- **Administratoren** haben vollen Zugriff

---

## H√§ufige Fragen

**Warum sehe ich ein Spiel nicht in der Liste?**
‚Üí Ihr seht nur Spiele eures eigenen Teams. Pr√ºft, ob eure Teamzuordnung korrekt eingestellt ist (sprecht ggf. den Trainer an).

**Das Ergebnis stimmt nicht ‚Äì wie korrigiere ich das?**
‚Üí √ñffnet das Spiel und korrigiert oder l√∂scht das falsch eingetragene Spielereignis (Tor oder Eigentor).

**Kann ich Tore auch noch nach dem Spiel nachtragen?**
‚Üí Ja! Die Spielereignisse k√∂nnen jederzeit nachtr√§glich erfasst oder korrigiert werden, solange das Spiel nicht gesperrt ist.

**Was ist, wenn Heim- und Ausw√§rtsteam nicht aus unserem Verein kommen?**
‚Üí Das Heimteam oder Ausw√§rtsteam darf auch freigelassen werden ‚Äì z. B. wenn ein externes Team noch nicht in Kaderblick erfasst ist. Das Ergebnis kann trotzdem protokolliert werden.

---

## Spiel√ºbersicht

Die Hauptseite der Spielverwaltung (`/games`) gliedert Spiele in drei Bereiche:

| Bereich | Beschreibung |
|---|---|
| **Laufende Spiele** | Spiele, deren Start in der Vergangenheit und deren Ende in der Zukunft liegt |
| **Bevorstehende Spiele** | Spiele mit Startzeit in der Zukunft, aufsteigend sortiert |
| **Vergangene Spiele** | Abgeschlossene Spiele, absteigend nach Datum, mit Endergebnis |

---

## Spiel anlegen

Ein Spiel verbindet zwei Teams miteinander und enth√§lt alle spielrelevanten Informationen.

### Felder eines Spiels

| Feld | Beschreibung | Pflicht |
|---|---|---|
| Heimteam | Eines der registrierten Teams | Nein* |
| Ausw√§rtsteam | Darf nicht dasselbe sein wie das Heimteam | Nein* |
| Spieltyp | z. B. Ligaspiel, Freundschaftsspiel, Turnierspiel | Ja |
| Ort / Location | Sportanlage, auf der gespielt wird | Nein |
| Liga | Optionale Zuordnung zu einer Liga | Nein |
| Heim-Tore | Endergebnis Heimteam | Nein |
| Ausw√§rts-Tore | Endergebnis Ausw√§rtsteam | Nein |
| Abgeschlossen | Markiert ein Spiel als beendet | Nein |
| Kalender-Ereignis | Verkn√ºpfter Termin (steuert Datum/Uhrzeit und Teilnahme) | Nein |
| fussball.de-ID | Kennung f√ºr automatische Synchronisation | Nein |

> *Heimteam und Ausw√§rtsteam k√∂nnen bewusst leer gelassen werden, z. B. bei externen Spielen gegen unbekannte Gegner.

Ein Spiel ist **immer** mit einem Kalender-Ereignis verkn√ºpft ‚Äì das Datum und die Uhrzeit werden dort verwaltet (siehe [Kalender & Teilnahme](07-kalender-teilnahme.md)).

---

## Spieltypen

Spieltypen kategorisieren Spiele und k√∂nnen verwaltet werden. Typische Werte: Ligaspiel, Pokalspiel, Freundschaftsspiel, Turnierspiel. Die Spieltypen sind √ºber die Datenbank konfigurierbar.

---

## Spielorte (Locations)

Spielorte sind eigenst√§ndige Entit√§ten, die Name und optional weitere Infos speichern. Sie k√∂nnen mehreren Spielen zugeordnet werden. Verwaltung √ºber Route `/locations`.

---

## Spielereignisse (GameEvents)

Spielereignisse protokollieren alles, was w√§hrend eines Spiels passiert. Jedes Ereignis ist dem Spiel, einem Team und optional einem Spieler sowie einer Spielminute zugeordnet.

### Bekannte Ereignistypen (GameEventTypes)

| Code | Bedeutung |
|---|---|
| `goal` | Regul√§res Tor |
| `own_goal` | Eigentor |
| `yellow_card` | Gelbe Karte |
| `yellow_red_card` | Gelb-Rote Karte |
| `red_card` | Rote Karte |
| `substitution` | Spielerwechsel |
| `assist` | Vorlage (Assist) |

Spielereignistypen sind √ºber `/gameEventTypes` konfigurierbar und erweiterbar.

### Score-Berechnung

Der aktuelle Spielstand wird nicht als fester Wert gespeichert, sondern wird **live aus den Spielereignissen berechnet**: Alle Ereignisse vom Typ `goal` werden gez√§hlt, Eigentore (`own_goal`) werden dem gegnerischen Team gutgeschrieben.

---

## Tore (Goals)

Tore sind eigenst√§ndige Entit√§ten und werden zus√§tzlich zu den Spielereignissen gespeichert. Sie enthalten:

| Feld | Beschreibung |
|---|---|
| Sch√ºtze | Spieler, der das Tor schoss |
| Vorbereiter (Assist) | Spieler, der das Tor vorbereitete |
| Spiel | Zugeh√∂riges Spiel |
| Spielminute | Minute des Tors |

---

## Wechsel (Substitutions)

Spielerwechsel werden als eigenst√§ndige Entit√§t gespeichert:

| Feld | Beschreibung |
|---|---|
| Einwechselspieler | Spieler, der eingewechselt wird |
| Auswechselspieler | Spieler, der ausgewechselt wird |
| Spiel | Zugeh√∂riges Spiel |
| Spielminute | Minute des Wechsels |
| Grund | Optionaler Wechselgrund (aus `SubstitutionReason`) |

---

## Spieldetailansicht

Die Detailseite eines Spiels (`/games/:id`) zeigt:

- Heimteam vs. Ausw√§rtsteam mit aktuellem Spielstand
- Chronologische Liste aller Spielereignisse (Tore, Karten, Wechsel)
- Verkn√ºpfte Videos mit Zeitleisten-Funktion (YouTube-Timestamps)
- Kamera-Zuordnungen f√ºr Videoanalyse
- Wetterdaten des Spieltermins

Benutzer sehen ein Spiel nur, wenn sie dem zugeh√∂rigen Verein/Team zugeordnet sind (Voter-Pr√ºfung).

---

## fussball.de-Synchronisation

Spiele und Teams k√∂nnen mit [fussball.de](https://www.fussball.de) verkn√ºpft werden. Sobald die Verkn√ºpfung eingerichtet ist, werden Spielergebnisse automatisch synchronisiert ‚Äì ohne manuelle Dateneingabe.

